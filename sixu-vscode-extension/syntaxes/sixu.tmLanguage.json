{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "SiXu",
	"scopeName": "source.sixu",
	"fileTypes": [".sixu"],
	"patterns": [
		{ "include": "#comment-single" },
		{ "include": "#comment-multi" },
		{ "include": "#scene" }
	],
	"repository": {
		"comment-single": {
			"name": "comment.line.double-slash.sixu",
			"match": "//.*$"
		},
		"comment-multi": {
			"name": "comment.block.sixu",
			"begin": "/\\*",
			"end": "\\*/",
			"patterns": [
				{
					"name": "comment.block.content.sixu",
					"match": "."
				}
			]
		},
		"scene": {
			"name": "meta.scene.sixu",
			"begin": "(::)([a-zA-Z_][a-zA-Z0-9_]*)\\s*(\\()?(.*?)(\\))?\\s*({)",
			"end": "}",
			"beginCaptures": {
				"1": { "name": "keyword.control.scene.sixu" },
				"2": { "name": "entity.name.function.sixu" },
				"3": { "name": "punctuation.definition.parameters.begin.sixu" },
				"4": { "patterns": [{ "include": "#parameters" }] },
				"5": { "name": "punctuation.definition.parameters.end.sixu" },
				"6": { "name": "punctuation.section.block.begin.sixu" }
			},
			"endCaptures": {
				"0": { "name": "punctuation.section.block.end.sixu" }
			},
			"patterns": [
				{ "include": "#comment-single" },
				{ "include": "#comment-multi" },
				{ "include": "#embedded-code" },
				{ "include": "#block" },
				{ "include": "#command-line" },
				{ "include": "#system-call-line" },
				{ "include": "#text-line" }
			]
		},
		"block": {
			"name": "meta.block.sixu",
			"begin": "{",
			"end": "}",
			"beginCaptures": {
				"0": { "name": "punctuation.section.block.begin.sixu" }
			},
			"endCaptures": {
				"0": { "name": "punctuation.section.block.end.sixu" }
			},
			"patterns": [
				{ "include": "#comment-single" },
				{ "include": "#comment-multi" },
				{ "include": "#embedded-code" },
				{ "include": "#block" },
				{ "include": "#command-line" },
				{ "include": "#system-call-line" },
				{ "include": "#text-line" }
			]
		},
		"embedded-code": {
			"name": "meta.embedded.block.javascript",
				"patterns": [
					{
						"begin": "##\\s*$",
						"end": "##\\s*$",
						"patterns": [
							{
								"include": "source.js"
							}
						]
					},
					{
						"match": "##\\s*(.+?)\\s*##",
						"captures": {
							"1": {
								"patterns": [
									{
										"include": "source.js"
									}
								]
							}
						}
					}
				]
		},
		"command-line": {
			"patterns": [
				{
					"match": "(@)([a-zA-Z_][a-zA-Z0-9_]*)(\\()(.*?)(\\))",
					"captures": {
						"1": { "name": "keyword.control.command.sixu" },
						"2": { "name": "entity.name.function.command.sixu" },
						"3": { "name": "punctuation.definition.arguments.begin.sixu" },
						"4": { "patterns": [{ "include": "#arguments" }] },
						"5": { "name": "punctuation.definition.arguments.end.sixu" }
					}
				},
				{
					"match": "(@)([a-zA-Z_][a-zA-Z0-9_]*)(\\s+.*)?$",
					"captures": {
						"1": { "name": "keyword.control.command.sixu" },
						"2": { "name": "entity.name.function.command.sixu" },
						"3": { "patterns": [{ "include": "#arguments" }] }
					}
				}
			]
		},
		"system-call-line": {
			"patterns": [
				{
					"match": "(#)([a-zA-Z_][a-zA-Z0-9_]*)(\\()(.*?)(\\))",
					"captures": {
						"1": { "name": "keyword.control.systemcall.sixu" },
						"2": { "name": "entity.name.function.systemcall.sixu" },
						"3": { "name": "punctuation.definition.arguments.begin.sixu" },
						"4": { "patterns": [{ "include": "#arguments" }] },
						"5": { "name": "punctuation.definition.arguments.end.sixu" }
					}
				},
				{
					"match": "(#)([a-zA-Z_][a-zA-Z0-9_]*)(\\s+.*)?$",
					"captures": {
						"1": { "name": "keyword.control.systemcall.sixu" },
						"2": { "name": "entity.name.function.systemcall.sixu" },
						"3": { "patterns": [{ "include": "#arguments" }] }
					}
				}
			]
		},
		"text-line": {
			"patterns": [
				{ "include": "#quoted-string" },
				{
					"match": "(?<![}@#:(),.{])(.+)$",
					"captures": {
						"1": { "name": "string.unquoted.sixu" }
					}
				}
			]
		},
		"quoted-string": {
			"patterns": [
				{
					"name": "string.quoted.double.sixu",
					"begin": "\"",
					"end": "\"",
					"patterns": [
						{
							"name": "constant.character.escape.sixu",
							"match": "\\\\(n|r|t|\\\\|/|\"|'|u\\{[0-9a-fA-F]{1,6}\\}|u[0-9a-fA-F]{1,4})"
						}
					]
				},
				{
					"name": "string.quoted.single.sixu",
					"begin": "'",
					"end": "'",
					"patterns": [
						{
							"name": "constant.character.escape.sixu",
							"match": "\\\\(n|r|t|\\\\|/|\"|'|u\\{[0-9a-fA-F]{1,6}\\}|u[0-9a-fA-F]{1,4})"
						}
					]
				}
			]
		},
		"parameters": {
			"patterns": [
				{
					"match": "([a-zA-Z_][a-zA-Z0-9_]*)\\s*(=)?",
					"captures": {
						"1": { "name": "variable.parameter.sixu" },
						"2": { "name": "keyword.operator.assignment.sixu" }
					}
				},
				{ "include": "#primitive-value" },
				{
					"match": ",",
					"name": "punctuation.separator.parameter.sixu"
				}
			]
		},
		"arguments": {
			"patterns": [
				{
					"match": "\\b([a-zA-Z_][a-zA-Z0-9_]*)\\s*(=)?",
					"captures": {
						"1": { "name": "variable.parameter.sixu" },
						"2": { "name": "keyword.operator.assignment.sixu" }
					}
				},
				{ "include": "#rvalue" },
				{
					"match": ",",
					"name": "punctuation.separator.argument.sixu"
				}
			]
		},
		"rvalue": {
			"patterns": [
				{ "include": "#primitive-value" },
				{ "include": "#variable-reference" }
			]
		},
		"primitive-value": {
			"patterns": [
				{ "include": "#quoted-string" },
				{
					"name": "constant.numeric.integer.sixu",
					"match": "[+-]?[0-9][0-9_]*"
				},
				{
					"name": "constant.language.boolean.true.sixu",
					"match": "\\btrue\\b"
				},
				{
					"name": "constant.language.boolean.false.sixu",
					"match": "\\bfalse\\b"
				}
			]
		},
		"variable-reference": {
			"match": "\\b([a-zA-Z_][a-zA-Z0-9_]*)((?:\\.[a-zA-Z_][a-zA-Z0-9_]*)*)\\b",
			"captures": {
				"1": { "name": "variable.other.sixu" },
				"2": { "name": "variable.other.member.sixu" }
			}
		}
	}
}